(function(t){function e(e){for(var a,r,c=e[0],o=e[1],l=e[2],p=0,u=[];p<c.length;p++)r=c[p],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&u.push(s[r][0]),s[r]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);_&&_(e);while(u.length)u.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,c=1;c<n.length;c++){var o=n[c];0!==s[o]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},s={app:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var _=o;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main-content"},[n("h1",{staticClass:"intro"},[t._v("Math Concept Annotator")]),n("nav",{staticStyle:{"margin-bottom":"20px"}},[n("div",{staticClass:"nav nav-tabs",attrs:{id:"nav-tab",role:"tablist"}},[n("a",{staticClass:"nav-item nav-link",class:{active:"upload"===t.active_tab},on:{click:function(e){return t.switch_tab("upload")}}},[t._v("Upload")]),n("a",{staticClass:"nav-item nav-link",class:{active:"math_concept"===t.active_tab},on:{click:function(e){return t.switch_tab("math_concept")}}},[t._v("Math Concept")]),n("a",{staticClass:"nav-item nav-link",class:{active:"adjudicate"===t.active_tab},on:{click:function(e){return t.switch_tab("adjudicate")}}},[t._v("Adjudicate")])])]),"upload"===t.active_tab?n("form",{staticClass:"row g-3"},[n("div",{staticClass:"col-auto"},[n("input",{staticClass:"form-control",attrs:{type:"text",placeholder:"Enter dataset name"},on:{change:function(e){return t.get_dataset_name(e)}}})]),n("div",{staticClass:"col-auto"},[n("input",{staticClass:"form-control",attrs:{type:"file",id:"dataset_selector",accept:".csv, .txt, .json, .jsonl, .tsv"},on:{change:function(e){return t.get_file_path(e)}}})]),n("div",{staticClass:"col-auto"},[n("button",{staticClass:"btn btn-primary mb-3",attrs:{type:"button"},on:{click:t.load_dataset_to_db}},[t._v("Load")])])]):t._e(),"upload"!==t.active_tab?n("form",{staticClass:"row g-3"},[n("div",{staticClass:"col-auto"},[n("div",{staticClass:"dropdown"},[n("button",{staticClass:"btn btn-secondary dropdown-toggle",attrs:{type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}},[t._v(" "+t._s(t.selector_val)+" ")]),n("ul",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton1"}},t._l(t.dataset_names[t.active_tab],(function(e,a){return n("li",{key:a,on:{click:function(e){return t.selector_show(e)}}},[n("a",{staticClass:"dropdown-item"},[t._v(t._s(e))])])})),0)])]),n("div",{staticClass:"col-auto"},[n("input",{staticClass:"form-control",attrs:{type:"text",placeholder:"Enter starting index"},on:{change:function(e){return t.get_starting_index(e)}}})]),n("div",{staticClass:"col-auto"},[n("button",{staticClass:"btn btn-primary mb-3",attrs:{type:" button"},on:{click:function(e){return t.start_annotation(e,t.active_tab)}}},[t._v("Start")])])]):t._e(),"alignment"===t.active_tab?n("div",{staticClass:"card cell"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"conclusion",attrs:{id:"buttonbar"}},[n("div",{staticClass:"addNew"},[n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.get_prev_example}},[n("i",{staticClass:"fas fa-arrow-left"})]),n("div",{staticClass:"addNew"}),n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.get_next_example}},[n("i",{staticClass:"fas fa-arrow-right"})])])]),t.staging.start_annotate?n("div",{staticClass:"conclusion card"},[n("div",{staticClass:"card-body passage-display-box"},[n("li",{staticClass:"list-group-item"},[n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("["+t._s(t.staging.current_example_id)+"]")])]),n("p",{staticClass:"card-text passage-text"},[t._m(0),t._l(t.staging.current_example.premise_tokens,(function(e,a){return n("span",{key:e.index,staticClass:"noselect",style:t.highlight_with_color(a,!0),on:{mousedown:function(e){return t.mousedown_text(a,!0)},mouseup:function(e){return t.mouseup_text(a,!0)},mouseenter:function(e){return t.mouseenter_text(a,!0)}}},[t._v(t._s(e+" "))])}))],2),n("p",{staticClass:"card-text"},[t._m(1),t._l(t.staging.current_example.hypothesis_tokens,(function(e,a){return n("span",{key:e.index,staticClass:"noselect",style:t.highlight_with_color(a,!1),on:{mousedown:function(e){return t.mousedown_text(a,!1)},mouseup:function(e){return t.mouseup_text(a,!1)},mouseenter:function(e){return t.mouseenter_text(a,!1)}}},[t._v(t._s(e+" "))])}))],2),n("p",{staticClass:"card-text"},[t._m(2),t._v(" "+t._s(t.staging.current_example.label)+" ")]),n("p",{staticClass:"card-text"},[t._m(3),t._v(" "+t._s(t.staging.current_example.reason)+" ")])]),n("div",{staticClass:"col-auto",staticStyle:{"margin-top":"20px",width:"50%"}},[n("input",{staticClass:"form-control span-input",attrs:{type:"text",placeholder:"premise span"},domProps:{value:t.display_selected_text(!0)}})]),n("div",{staticClass:"col-auto",staticStyle:{"margin-top":"20px",width:"50%"}},[n("input",{staticClass:"form-control span-input",attrs:{type:"text",placeholder:"hypothesis span"},domProps:{value:t.display_selected_text(!1)}})]),n("div",{staticClass:"btn-group",staticStyle:{float:"left"}},[n("button",{staticClass:"btn btn-primary",staticStyle:{margin:"25px 0px 10px 0px"},attrs:{type:"button"},on:{click:t.add_alignment}},[t._v(" Add Alignment ")])]),n("button",{staticClass:"btn btn-secondary",staticStyle:{margin:"25px 0px 10px 0px",float:"right"},attrs:{type:"button"},on:{click:t.submit_current}},[t._v(" Submit Annotation ")])]),n("ul",{staticClass:"list-group",staticStyle:{margin:"30px"}},t._l(t.staging.current_example.alignments,(function(e,a){return n("li",{key:a,staticClass:"\n                  list-group-item\n                  d-flex\n                  justify-content-between\n                  align-items-center\n                "},[n("span",{staticStyle:{color:"DodgerBlue","font-size":"14px"}},[n("strong",[t._v(" "+t._s("["+e.align_p.text+"]")+" "),n("i",{staticClass:"fas fa-arrow-right"}),t._v(" "+t._s("["+e.align_h.text+"]")+" ")])]),n("button",{staticClass:"btn btn-outline-danger",staticStyle:{"margin-right":"10px"},attrs:{type:"button","data-balloon-pos":"up","aria-label":"Delete Alignment"},on:{click:function(e){return t.remove_alignment(a)}}},[n("i",{staticClass:"fas fa-times"})])])})),0)]):t._e()])]):t._e(),"intervention"===t.active_tab?n("div",{staticClass:"card cell"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"conclusion",attrs:{id:"buttonbar"}},[n("div",{staticClass:"addNew"},[n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.get_prev_example}},[n("i",{staticClass:"fas fa-arrow-left"})]),n("div",{staticClass:"addNew"}),n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.get_next_example}},[n("i",{staticClass:"fas fa-arrow-right"})])])]),t.staging.start_annotate?n("div",{staticClass:"conclusion card"},[n("div",{staticClass:"card-body passage-display-box"},[n("li",{staticClass:"list-group-item"},[n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("["+t._s(t.staging.current_example_id)+"]")])]),n("p",{staticClass:"card-text passage-text"},[t._m(4),t._l(t.staging.current_example.premise_tokens,(function(e,a){return n("span",{key:e.index,staticClass:"noselect",style:t.highlight_with_color(a,!0),on:{mousedown:function(e){return t.mousedown_text(a,!0)},mouseup:function(e){return t.mouseup_text(a,!0)},mouseenter:function(e){return t.mouseenter_text(a,!0)}}},[t._v(t._s(e+" "))])}))],2),n("p",{staticClass:"card-text"},[t._m(5),t._l(t.staging.current_example.hypothesis_tokens,(function(e,a){return n("span",{key:e.index,staticClass:"noselect",style:t.highlight_with_color(a,!1),on:{mousedown:function(e){return t.mousedown_text(a,!1)},mouseup:function(e){return t.mouseup_text(a,!1)},mouseenter:function(e){return t.mouseenter_text(a,!1)}}},[t._v(t._s(e+" "))])}))],2),n("p",{staticClass:"card-text"},[t._m(6),t._v(" "+t._s(t.staging.current_example.label)+" ")]),n("p",{staticClass:"card-text"},[t._m(7),t._v(" "+t._s(t.staging.current_example.reason)+" ")])]),t._m(8),t._m(9),n("div",{staticClass:"btn-group",staticStyle:{float:"left"}},[n("button",{staticClass:"btn btn-primary",staticStyle:{margin:"25px 0px 10px 0px"},attrs:{type:"button"},on:{click:t.add_alignment}},[t._v(" Add Intervention ")])]),n("button",{staticClass:"btn btn-secondary",staticStyle:{margin:"25px 0px 10px 0px",float:"right"},attrs:{type:"button"},on:{click:t.submit_current}},[t._v(" Submit Example ")])]),n("ul",{staticClass:"list-group",staticStyle:{margin:"30px"}},t._l(t.staging.current_example.alignments,(function(e,a){return n("li",{key:a,staticClass:"\n                  list-group-item\n                  d-flex\n                  justify-content-between\n                  align-items-center\n                "},[n("span",{staticStyle:{color:"DodgerBlue","font-size":"14px"}},[n("strong",[t._v(" "+t._s("["+e.align_p.text+"]")+" "),n("i",{staticClass:"fas fa-arrow-right"}),t._v(" "+t._s("["+e.align_h.text+"]")+" ")])]),n("button",{staticClass:"btn btn-outline-danger",staticStyle:{"margin-right":"10px"},attrs:{type:"button","data-balloon-pos":"up","aria-label":"Delete Alignment"},on:{click:function(e){return t.remove_alignment(a)}}},[n("i",{staticClass:"fas fa-times"})])])})),0)]):t._e()])]):t._e(),"math_concept"===t.active_tab?n("form",{staticClass:"card cell"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"conclusion",attrs:{id:"buttonbar"}},[n("div",{staticClass:"addNew"},[n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.get_prev_example}},[n("i",{staticClass:"fas fa-arrow-left"})]),n("div",{staticClass:"addNew"}),n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.get_next_example}},[n("i",{staticClass:"fas fa-arrow-right"})])])]),t.staging.start_annotate?n("div",{staticClass:"conclusion card"},[n("div",{staticClass:"card-body passage-display-box"},[n("li",{staticClass:"list-group-item"},[n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("["+t._s(t.staging.current_example_id)+"]")])]),n("p",{staticClass:"card-text passage-text"},[t._m(10),t._l(t.staging.current_example.premise_tokens,(function(e,a){return n("span",{key:e.index,staticClass:"noselect",style:t.highlight_with_color(a,!0),on:{mousedown:function(e){return t.mousedown_text(a,!0)},mouseup:function(e){return t.mouseup_text(a,!0)},mouseenter:function(e){return t.mouseenter_text(a,!0)}}},[t._v(t._s(e+" "))])}))],2)]),n("div",{staticClass:"col-auto",staticStyle:{"margin-top":"20px",width:"50%"}},[n("input",{staticClass:"form-control span-input",attrs:{type:"text",placeholder:"selected math concepts"},domProps:{value:t.display_selected_text(!0)},on:{change:function(e){return t.get_concept_span(e)}}})]),n("div",{staticClass:"btn-group",staticStyle:{float:"left"}},[n("button",{staticClass:"btn btn-primary",staticStyle:{margin:"25px 0px 10px 0px"},attrs:{type:"button"},on:{click:t.add_concept}},[t._v(" Add Concepts ")])]),n("button",{staticClass:"btn btn-secondary",staticStyle:{margin:"25px 0px 10px 0px",float:"right"},attrs:{type:"button"},on:{click:t.submit_concepts}},[t._v(" Submit Annotation ")])]),n("ul",{staticClass:"list-group",staticStyle:{margin:"30px"}},t._l(t.staging.current_example.concepts,(function(e,a){return n("li",{key:a,staticClass:"\n                  list-group-item\n                  d-flex\n                  justify-content-between\n                  align-items-center\n                "},[n("span",{staticStyle:{color:"DodgerBlue","font-size":"14px"}},[n("strong",[t._v(" "+t._s("["+e.concept+"]")+" ")])]),n("button",{staticClass:"btn btn-outline-danger",staticStyle:{"margin-right":"10px"},attrs:{type:"button","data-balloon-pos":"up","aria-label":"Delete Concept"},on:{click:function(e){return t.remove_concept(a)}}},[n("i",{staticClass:"fas fa-times"})])])})),0)]):t._e()])]):t._e(),"adjudicate"===t.active_tab?n("form",{staticClass:"card cell"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"conclusion",attrs:{id:"buttonbar"}},[n("div",{staticClass:"addNew"},[n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.get_prev_example}},[n("i",{staticClass:"fas fa-arrow-left"})]),n("div",{staticClass:"addNew"}),n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.get_next_example}},[n("i",{staticClass:"fas fa-arrow-right"})])])]),t.staging.start_annotate?n("div",{staticClass:"conclusion card"},[n("div",{staticClass:"card-body passage-display-box"},[n("li",{staticClass:"list-group-item"},[n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("["+t._s(t.staging.current_example_id)+"]")])]),n("p",{staticClass:"card-text passage-text"},[t._m(11),t._l(t.staging.current_example.premise_tokens,(function(e,a){return n("span",{key:e.index,staticClass:"noselect",style:t.highlight_with_color(a,!0),on:{mousedown:function(e){return t.mousedown_text(a,!0)},mouseup:function(e){return t.mouseup_text(a,!0)},mouseenter:function(e){return t.mouseenter_text(a,!0)}}},[t._v(t._s(e+" "))])}))],2)]),n("div",{staticClass:"col-auto",staticStyle:{"margin-top":"20px",width:"50%"}},[n("input",{staticClass:"form-control span-input",attrs:{type:"text",placeholder:"selected math concepts"},domProps:{value:t.display_selected_text(!0)},on:{change:function(e){return t.get_concept_span(e)}}})]),n("div",{staticClass:"btn-group",staticStyle:{float:"left"}},[n("button",{staticClass:"btn btn-primary",staticStyle:{margin:"25px 0px 10px 0px"},attrs:{type:"button"},on:{click:t.add_concept}},[t._v(" Add Concepts ")])]),n("button",{staticClass:"btn btn-secondary",staticStyle:{margin:"25px 0px 10px 0px",float:"right"},attrs:{type:"button"},on:{click:t.submit_concepts}},[t._v(" Submit Annotation ")])]),n("div",[n("div",{staticStyle:{float:"left"}},[t._m(12),n("ul",{staticClass:"list-group",staticStyle:{margin:"30px"}},t._l(t.staging.current_example.concepts,(function(e,a){return n("li",{key:a,staticClass:"\n                  list-group-item\n                  d-flex\n                  justify-content-between\n                  align-items-center\n                "},[n("span",{staticStyle:{color:"DodgerBlue","font-size":"14px"}},[n("strong",[t._v(" "+t._s("["+e.concept+"]")+" ")])]),n("button",{staticClass:"btn btn-outline-warning",class:{active:t.staging.current_example.marks[a]},staticStyle:{color:"rgb(255, 30, 30)",margin:"0px 10px 0px 30px"},attrs:{type:"button","data-balloon-pos":"up","aria-label":"Mark Concept"},on:{click:function(e){return t.mark_concept(a,"human")}}},[n("i",{staticClass:"fas fa-check"})])])})),0)]),n("div",{staticStyle:{float:"right"}},[t._m(13),n("ul",{staticClass:"list-group",staticStyle:{margin:"30px"}},t._l(t.staging.current_example.chatgpt_concepts,(function(e,a){return n("li",{key:a,staticClass:"\n                  list-group-item\n                  d-flex\n                  justify-content-between\n                  align-items-center\n                "},[n("span",{staticStyle:{color:"DodgerBlue","font-size":"14px"}},[n("strong",[t._v(" "+t._s("["+e.concept+"]")+" ")])]),n("button",{staticClass:"btn btn-outline-warning",class:{active:t.staging.current_example.chatgpt_marks[a]},staticStyle:{color:"rgb(255, 30, 30)",margin:"0px 10px 0px 30px"},attrs:{type:"button","data-balloon-pos":"up","aria-label":"Mark Concept"},on:{click:function(e){return t.mark_concept(a,"chatgpt")}}},[n("i",{staticClass:"fas fa-check"})])])})),0)])])]):t._e()])]):t._e(),n("form",{staticClass:"row g-2"},[n("div",{staticClass:"col-auto"},[n("button",{staticClass:"btn btn-primary mb-3",attrs:{type:"button"},on:{click:t.download_annotation}},[t._v(" Download ")])])])])},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("[PREMISE]")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("[HYPOTHESIS]")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("[LABEL]")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("[REASON]")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("[PREMISE]")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("[HYPOTHESIS]")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("[LABEL]")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("[REASON]")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-auto",staticStyle:{"margin-top":"20px",width:"50%"}},[n("input",{staticClass:"form-control span-input",attrs:{type:"text",placeholder:"premise span"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-auto",staticStyle:{"margin-top":"20px",width:"50%"}},[n("input",{staticClass:"form-control span-input",attrs:{type:"text",placeholder:"hypothesis span"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("[Sentence]")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue"}},[n("strong",[t._v("[Sentence]")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue","font-size":"20px",margin:"30px"}},[n("strong",[t._v(" HUMAN ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{color:"DodgerBlue","font-size":"20px",margin:"30px"}},[n("strong",[t._v(" ChatGPT ")])])}],r=(n("caad"),n("2532"),n("d3b7"),n("159b"),n("ac1f"),n("1276"),n("5319"),n("e9c4"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("a15b"),n("fb6a"),n("a434"),n("0ff2")),c=n("260b"),o=(n("e71f"),{apiKey:"AIzaSyA2YV_7vBX6Bl1zf1bV0pporDz_zo2ogQk",authDomain:"concept-extraction-48c36.firebaseapp.com",databaseURL:"https://concept-extraction-48c36-default-rtdb.firebaseio.com",projectId:"concept-extraction-48c36",storageBucket:"concept-extraction-48c36.appspot.com",messagingSenderId:"106750213656",appId:"1:106750213656:web:f1e40c07e001f78759cd6d"});c["a"].initializeApp(o);var l=c["a"].firestore();a["a"].use(r["a"]);var _=new FileReader,p={e:"Entailment",c:"Contradiction",n:"neutral"},u={name:"AnnotationInterface",components:{},props:["id"],data:function(){return{active_tab:"alignment",frozen:!0,frozen_time:3,seconds_remain:180,data_loaded:!1,concept_tabs:["math_concept","adjudicate"],dataset_names:{false:["anli_r1_test","anli_r1_train","anli_r1_val","anli_r2_test","anli_r2_train","anli_r2_val","anli_r3_test","anli_r3_train","anli_r3_val","snli_train","snli_val","snli_test","test_train"],true:["new_100_Larry","new_100_Valeria","new_100_Pavel","436_sentences","test_train","436_sentences_ad","nlab_demo"],math_concept:["new_100_Larry","new_100_Valeria","new_100_Pavel","436_sentences","test_train","nlab_demo"],adjudicate:["436_sentences","nlab_demo"]},selector_val:"Select Dataset",token_style:{background:"inherit"},color_palette:["#ffd200","#fa9900","#d9d2e9","#cebff0","#ff9b95","#f5cfc1","#e98e00"],staging:{dataset:null,loading_dataset_name:null,current_dataset_name:null,dataset_path:null,download_folder:null,start_annotate:!1,starting_index:0,current_example_id:0,current_example:null,current_dp:null,examples:{},datalist:[],changes:[],change_ids:[]}}},methods:{switch_tab:function(t){this.active_tab=t},get_dataset_name:function(t){this.staging.loading_dataset_name=t.target.value},get_file_path:function(t){var e=t.target.files;this.staging.datalistset_path=e[0]},get_folder_path:function(t){var e=t.target.files;this.staging.download_folder=e[0].path},selector_show:function(t){t.preventDefault(),this.selector_val=t.target.innerHTML,this.staging.current_dataset_name=t.target.innerHTML},get_concept_span:function(t){this.staging.current_example.selected_concept=t.target.value},get_starting_index:function(t){this.staging.starting_index=parseInt(t.target.value)},start_annotation:function(t,e){var n=this;t.preventDefault(),this.dataset_names[this.concept_tabs.includes(e)].includes(this.staging.current_dataset_name)?(this.dataset=l.collection(this.staging.current_dataset_name),this.machine_dataset=l.collection(this.staging.current_dataset_name+"_chatgpt"),this.machine_dataset.limit(1).get().then((function(t){0===t.size&&(n.machine_dataset=void 0)})),this.staging.examples={},this.staging.datalist=[],this.staging.current_example_id=this.staging.starting_index,this.query_datapoint()):alert("ERROR: dataset does not exit, upload before annotation!")},query_datapoint:function(){var t=this;this.dataset.where("index","==",this.staging.current_example_id).get().then((function(e){e.forEach((function(e){t.staging.current_dp=e.data(),t.build_container(t.staging.current_dp),t.add_machine_concepts()})),t.staging.start_annotate||(t.staging.start_annotate=!0)})).catch((function(t){console.log("Error getting documents: ",t)}))},build_container:function(t){this.staging.datalist.push(t);var e={premise:t["premise"],hypothesis:t["hypothesis"],label:t["label"],reason:t["reason"],premise_tokens:t["premise"].split(" "),hypothesis_tokens:t["hypothesis"].split(" "),alignments:[],concepts:[],chatgpt_concepts:[],marks:[],chatgpt_marks:[],selected_concept:"",selection_p:{start:-1,end:-1,current:-1,state:"none"},selection_h:{start:-1,end:-1,current:-1,state:"none"},token_color_id_p:0,token_color_id_h:0,token_background_color_p:{},token_background_color_h:{},selected_token_indices_p:{},selected_token_indices_h:{}};"alignments"in t&&(e["alignments"]=t["alignments"]),"concepts"in t&&(e["concepts"]=t["concepts"],e["concepts"].forEach((function(t){"undefined"===typeof t.is_marked?e["marks"].push(!1):e["marks"].push(t.is_marked)}))),"chatgpt_concepts"in t&&(e["chatgpt_concepts"]=t["chatgpt_concepts"],e["chatgpt_concepts"].forEach((function(t){"undefined"===typeof t.is_marked?e["chatgpt_marks"].push(!1):e["chatgpt_marks"].push(t.is_marked)}))),e.token_background_color_p=this.init_color_for_token(e.premise_tokens),e.token_background_color_h=this.init_color_for_token(e.hypothesis_tokens),this.staging.current_example=e,this.staging.examples[this.staging.current_example_id]=e},get_machine_concepts:function(){if("undefined"===typeof this.machine_dataset)return[];this.machine_dataset.where("index","==",this.staging.current_example_id).get().then((function(t){t.forEach((function(t){var e=t.data();return"concepts"in e?(console.log(e["concepts"]),e["concepts"]):[]}))})).catch((function(t){console.log("Error getting documents: ",t)}))},add_machine_concepts:function(){var t=this;if("undefined"===typeof this.machine_dataset)return this.staging.current_example["chatgpt_concepts"]=[],void(this.staging.current_example["chatgpt_marks"]=[]);this.machine_dataset.where("index","==",this.staging.current_example_id).get().then((function(e){e.forEach((function(e){var n=e.data();"concepts"in n?(t.staging.current_example["chatgpt_concepts"]=n["concepts"],t.staging.current_example["chatgpt_concepts"].forEach((function(e){"undefined"===typeof e.is_marked?t.staging.current_example["chatgpt_marks"].push(!1):t.staging.current_example["chatgpt_marks"].push(e.is_marked)}))):(t.staging.current_example["chatgpt_concepts"]=[],t.staging.current_example["chatgpt_marks"]=[])}))})).catch((function(t){console.log("Error getting documents: ",t)}))},init_color_for_token:function(t){for(var e={},n=0;n<t.length;n++)e[n]="inherit";return e},load_dataset_to_db:function(){var t=this;_.onload=function(e){t.staging.datalistset=e.target.result.replace(/\r\n/g,"\n").split("\n");var n=0;t.staging.datalistset.forEach((function(e){var a=JSON.parse(e),s="",i="";t.staging.loading_dataset_name.includes("anli")?(s=a["reason"],i=p[a["label"]]):("explanation_1"in a&&(s=a["explanation_1"]),"label"in a&&(i=a["label"])),"concepts"in a||(a["concepts"]=[]),"chatgpt_concepts"in a||(a["chatgpt_concepts"]=[]),l.collection(t.staging.loading_dataset_name).add({index:n,concepts:a["concepts"],chatgpt_concepts:a["chatgpt_concepts"],premise:a["premise"],hypothesis:a["hypothesis"],label:i,reason:s}).then((function(t){console.log("Document written with ID: ",t.id)})).catch((function(t){console.error("Error adding document: ",t)})),n+=1}))},_.onerror=function(t){return console.log(t)},_.readAsText(this.staging.datalistset_path)},download_annotation:function(){var t=this;if("undefined"!==typeof this.dataset){var e=[];this.dataset.get().then((function(n){n.forEach((function(t){var n=t.data();e.push(n)}));var a=JSON.stringify(e),s=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(s),r=document.createElement("a");r.href=i,r.download=t.staging.current_dataset_name+"_data.json",r.click(),URL.revokeObjectURL(r.href)})).catch((function(t){console.log("Error getting documents: ",t)}))}else alert("Please select a dataset to start annotation first.")},get_prev_example:function(){if(this.staging.current_example_id>0){this.staging.current_example_id-=1;var t=this.staging.current_example_id;t in this.staging.examples?(this.staging.current_example=this.staging.examples[t],this.staging.current_dp=this.staging.datalist[t]):this.query_datapoint()}},get_next_example:function(){this.staging.current_example_id+=1;var t=this.staging.current_example_id;t in this.staging.examples?(this.staging.current_example=this.staging.examples[t],this.staging.current_dp=this.staging.datalist[t]):this.query_datapoint()},add_alignment:function(){var t=this.staging.current_example.selection_h,e=this.staging.current_example.hypothesis_tokens,n=this.staging.current_example.selection_p,a=this.staging.current_example.premise_tokens,s="",i="";n.start>=0&&n.end>=0&&(s=a.slice(n.start,n.end+1).join(" ")),t.start>=0&&t.end>=0&&(i=e.slice(t.start,t.end+1).join(" "));var r={align_p:{start:n.start,end:n.end,text:s},align_h:{start:t.start,end:t.end,text:i}};this.staging.current_example.alignments.push(r),this.clear_selection(),this.do_highlight_alignment_selection(r),this.rotate_color_id()},add_concept:function(){var t=this.staging.current_example.selected_concept,e=this.staging.current_example.selection_h,n=this.staging.current_example.selection_p,a={align_p:{start:n.start,end:n.end},align_h:{start:e.start,end:e.end},concept:t};this.staging.current_example.concepts.push(a),this.clear_selection(),this.do_highlight_alignment_selection(a),this.rotate_color_id(),-1!==this.staging.change_ids.indexOf(this.staging.current_example_id)||(this.staging.change_ids.push(this.staging.current_example_id),this.staging.changes.push([this.staging.current_example_id,this.staging.current_example]))},remove_alignment:function(t){var e=JSON.stringify(this.staging.current_example.alignments[t]);this.staging.current_example.alignments.splice(t,1),this.undo_highlight_alignment_selection(JSON.parse(e))},remove_concept:function(t){var e=JSON.stringify(this.staging.current_example.concepts[t]);this.staging.current_example.concepts.splice(t,1),-1!==this.staging.change_ids.indexOf(this.staging.current_example_id)||(this.staging.change_ids.push(this.staging.current_example_id),this.staging.changes.push([this.staging.current_example_id,this.staging.current_example])),this.undo_highlight_alignment_selection(JSON.parse(e))},mark_concept:function(t,e){var n=this.smart_select_concept(t,e);"undefined"===typeof n.is_marked?n.is_marked=!0:n.is_marked=!n.is_marked,"chatgpt"===e?this.staging.current_example.chatgpt_marks=this.summarize_marks(this.staging.current_example.chatgpt_concepts):this.staging.current_example.marks=this.summarize_marks(this.staging.current_example.concepts),-1!==this.staging.change_ids.indexOf(this.staging.current_example_id)||(this.staging.change_ids.push(this.staging.current_example_id),this.staging.changes.push([this.staging.current_example_id,this.staging.current_example]))},summarize_marks:function(t){var e=[];return t.forEach((function(t){"undefined"===typeof t.is_marked?(t.is_marked=!1,e.push(!1)):e.push(t.is_marked)})),e},smart_select_concept:function(t,e){var n="";return n="chatgpt"===e?this.staging.current_example.chatgpt_concepts[t]:this.staging.current_example.concepts[t],n},submit_current:function(){var t=this;0==this.staging.current_example.alignments.length?alert("No alignment pairs are annotated !"):this.dataset.where("index","==",this.staging.current_example_id).limit(1).get().then((function(e){var n=e.docs[0];n.ref.update({is_annotated:!0,alignments:t.staging.current_example.alignments}).then((function(){alert("Document successfully updated!")}))})).catch((function(t){alert("Error getting documents: ",t)}))},submit_concepts:function(){var t=this;this.staging.changes.forEach((function(e){var n=e[0],a=e[1];t.dataset.where("index","==",n).limit(1).get().then((function(t){var e=t.docs[0];e.ref.update({is_annotated:!0,concepts:a.concepts,chatgpt_concepts:a.chatgpt_concepts})})).catch((function(t){alert("Error getting documents: ",t)}))})),this.staging.changes.length>0&&alert("Document successfully updated!"),this.staging.changes=[],this.staging.change_ids=[]},do_highlight_alignment_selection:function(t){for(var e=this.color_palette[this.staging.current_example.token_color_id_p],n=this.color_palette[this.staging.current_example.token_color_id_h],a=t.align_p.start;a<=t.align_p.end;a++)this.staging.current_example.token_background_color_p[a]=e;for(var s=t.align_h.start;s<=t.align_h.end;s++)this.staging.current_example.token_background_color_h[s]=n},undo_highlight_alignment_selection:function(t){for(var e=t.align_p.start;e<=t.align_p.end;e++)this.staging.current_example.token_background_color_p[e]="inherit";for(var n=t.align_h.start;n<=t.align_h.end;n++)this.staging.current_example.token_background_color_h[n]="inherit"},rotate_color_id:function(){this.staging.current_example.token_color_id_p+=1,this.staging.current_example.token_color_id_p>6&&(this.staging.current_example.token_color_id_p=0),this.staging.current_example.token_color_id_h+=1,this.staging.current_example.token_color_id_h>6&&(this.staging.current_example.token_color_id_h=0)},highlight_with_color:function(t,e){return this.is_in_selection_highlight(t,e)?{background:"lightskyblue"}:e?{background:this.staging.current_example.token_background_color_p[t]}:{background:this.staging.current_example.token_background_color_h[t]}},should_highlight:function(t,e){return e?!0===this.staging.current_example.selected_token_indices_p[t]:!0===this.staging.current_example.selected_token_indices_h[t]},mousedown_text:function(t,e){e?(this.staging.current_example.selection_p.start=t,this.staging.current_example.selection_p.state="selecting"):(this.staging.current_example.selection_h.start=t,this.staging.current_example.selection_h.state="selecting")},mouseup_text:function(t,e){if(e){this.staging.current_example.selection_p.end=t,this.staging.current_example.selection_p.state="none";var n=Math.min(this.staging.current_example.selection_p.start,this.staging.current_example.selection_p.end),a=Math.max(this.staging.current_example.selection_p.start,this.staging.current_example.selection_p.end);this.staging.current_example.selection_p.start=n,this.staging.current_example.selection_p.end=a}else{this.staging.current_example.selection_h.end=t,this.staging.current_example.selection_h.state="none";var s=Math.min(this.staging.current_example.selection_h.start,this.staging.current_example.selection_h.end),i=Math.max(this.staging.current_example.selection_h.start,this.staging.current_example.selection_h.end);this.staging.current_example.selection_h.start=s,this.staging.current_example.selection_h.end=i}},mouseenter_text:function(t,e){e?this.staging.current_example.selection_p.current=t:this.staging.current_example.selection_h.current=t},display_selected_text:function(t){var e=this.staging.current_example.selection_h,n=this.staging.current_example.hypothesis_tokens;if(t&&(e=this.staging.current_example.selection_p,n=this.staging.current_example.premise_tokens),e.start>=0&&e.end>=0){var a=n.slice(e.start,e.end+1).join(" ");return this.staging.current_example.selected_concept=a,a}return""},clear_selection:function(){this.staging.current_example.selection_p.state="none",this.staging.current_example.selection_p.start=-1,this.staging.current_example.selection_p.end=-1,this.staging.current_example.selection_p.current=-1,this.staging.current_example.selection_h.state="none",this.staging.current_example.selection_h.start=-1,this.staging.current_example.selection_h.end=-1,this.staging.current_example.selection_h.current=-1},invalidate_selection:function(){"none"!==this.staging.current_example.selection.state&&this.clear_selection()},is_in_selection_highlight:function(t,e){var n=this.staging.current_example.selection_h;return e&&(n=this.staging.current_example.selection_p),"selecting"===n.state?t>=Math.min(n.current,n.start)&&t<=Math.max(n.current,n.start):"none"===n.state&&(t>=n.start&&t<=n.end)}}},g=u,d=n("2877"),h=Object(d["a"])(g,s,i,!1,null,null,null),m=h.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(m)}}).$mount("#app")}});
//# sourceMappingURL=app.126990e9.js.map